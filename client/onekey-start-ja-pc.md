## JarClient的PC端一键启动方案（基于JavaAgent）

运行环境要求：Java 8或更高

得益于新的JavaAgent启动方式，Jar客户端可以任意启动器的热更新功能，不再依赖启动器的`启动前指令`功能。因此此方法可以适用于任何启动器！

### 1.准备工作

首先参考[Jar客户端](jar-client.md)的教程，搭建并配置好一个可用的Jar客户端（指独立启动没问题）

注意Jar客户端的版本需要大于等于4.1，只有4.1版本开始才支持作为`javaagent`参数启动

将Jar客户端和配置文件（如果有）移动到`.minecraft/`目录下

### 2.移除签名证书

将游戏核心Jar文件，比如`.minecraft/versions/1.12.2/1.12.2.jar`用压缩软件打开，删除`META-INF/`目录下的`MOJANGCS.RSA`和`MOJANGCS.SF`文件并保存，这一步很重要，请不要遗漏

### 3.配置JVM参数

打开启动器，找到JVM（Java虚拟机）参数，在现有内容的最前面插入一段`-javaagent:JarClient.jar`（`JarClient.jar`文件名记得换成实际的文件名）

如果你的`JarClient.jar`不在此处，请自行修改路径，此相对路径的起始路径是`.minecraft`目录

上面一步非常重要，请再输入完成后务必仔细检查，不能打错一个字，否则游戏直接闪退

如果你有多个`javaagent`参数，请确保位于所有参数的最前面

### 4.启动测试

接着启动游戏，测试效果。如果你希望看到详细的日志输出过程，可以打开启动器的日志窗口。如果希望看到完整的日志，可以查看`JarClient.jar`文件旁边的`balloon_update.txt`文件

## 无窗口模式

当Jar客户端在PC机上运行时，会自动检测是否是桌面环境，如果是，则会显示包含进度条的窗口

如果你不希望显示窗口，而是希望像[安卓端更新方案](java-agent-based-mobile.md)那样全程以无窗口方式运行，你可以添加一个javaagent参数`windowless`，来开启**无窗口模式**，比如这样配置JVM参数：`-javaagent:JarClient-0.0.0.jar=windowless`。则即使是桌面环境，也不会显示更新进度条，所有更新过程将完全在后台运行

## 游戏崩溃专题

当Jar客户端遇到网络问题，配置文件问题，或者其它原因出现错误的时候，会主动崩溃Minecraft进程，以此来告诉你更新失败了，所以如果发生了游戏闪退，请首先查看日志，判断是不是因为更新失败造成的。当然一般出现错误的时候，都会有弹框显示告诉你，避免手动查日志这个繁琐的工作（如果你开了无窗口模式，则没有任何错误弹窗显示）

如果你不希望在更新出现问题时直接闪退这种简单粗暴的机制，你可以在配置文件开启`no-throwing`选项。开启后如果遇到网络原因无法更新，就不会闪退，而是继续启动Minecraft。虽然不会闪退，但也可能因为服务器新增了模组而导致进不去服务器的情况，所以此选项请自行决定是否开启